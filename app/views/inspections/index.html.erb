<h2>PAT Inspection Records</h2>

<div class="search-box">
  <%= form_with url: search_inspections_path, method: :get do |form| %>
    <%= form.text_field :query, placeholder: "Search by Serial Number...", value: params[:query] %>
    <%= form.submit "Search" %>
  <% end %>
</div>

<div class="inspections-container">
  <% if @inspections.any? %>
    <table class="inspections-table">
      <thead>
        <tr>
          <th>Serial/Asset</th>
          <th>Description</th>
          <th>Location</th>
          <th>Last Inspection</th>
          <th>Next Due</th>
          <th>Result</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @inspections.each do |inspection| %>
          <tr>
            <td><%= inspection.serial %></td>
            <td><%= inspection.description %></td>
            <td><%= inspection.location %></td>
            <td><%= inspection.inspection_date&.strftime('%d/%m/%Y') %></td>
            <td><%= inspection.reinspection_date&.strftime('%d/%m/%Y') %></td>
            <td class="<%= inspection.passed ? 'pass' : 'fail' %>">
              <%= inspection.passed ? 'PASS' : 'FAIL' %>
            </td>
            <td class="actions">
              <%= link_to "View", inspection_path(inspection), class: 'action-link view' %>
              <%= link_to "Edit", edit_inspection_path(inspection), class: 'action-link edit' %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <div class="no-inspections">
      <p>No inspection records found.</p>
    </div>
  <% end %>
</div>

<div class="actions-container">
  <%= link_to "New Inspection", new_inspection_path, class: 'button new' %>
</div>
